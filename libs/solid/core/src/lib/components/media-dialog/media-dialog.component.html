<ng-container *ngIf="data.type === 'mediaObject'">
  <div mat-dialog-title class="mat-dialog-title">
    <div>
      {{ data.name }}
      <span *ngIf="data.mediaObject.getTitle" class="media-object-title">
        - {{ data.mediaObject.getTitle }}</span
      >
    </div>
    <button mat-icon-button mat-dialog-close>
      <mat-icon>close</mat-icon>
    </button>
    <!-- The focus in dialog might be a new feature within Angular 12 and Material 12.
    Use fake-btn to avoid "focus" (has background) on the real close button when the dialog
    is first opened. cdkFocusInitial distract the "focus" of real close button to fake button -->
    <!-- Bad solution, but figured out no better solution -->
    <button cdkFocusInitial class="fake-btn"></button>
  </div>
  <ng-container
    *ngIf="data.mediaObject.deepZoomLink as dziFile; then deepZoom; else noZoom"
  ></ng-container>
  <!-- I decide to keep it bcs we maybe need it in the future -->
  <!-- <div id="description-container" *ngIf="hasDescription">
  <span markdown [data]="data.mediaObject.description"></span>
  </div> -->
  <ng-template #deepZoom>
    <div mat-dialog-content>
      <div id="dzi-container"></div>
      <div class="toolbar-container">
        <div class="spacer"></div>
        <solid-core-audio-toolbar
          *ngIf="hasAudio"
          [audiosrc]="data.mediaObject.audiosrc"
          [toolbar]="true"
          [class.openAudioToolbar]="audioPlayBtnClicked"
          [playAudio]="audioPlayBtnClicked"
          (audioErrorEventEmitter)="handleAudioErrorEvent($event)"
          (audioEndedEventEmitter)="handleAudioEndedEvent($event)"
          [class.closeAudioToolbar]="audioEnded"
        ></solid-core-audio-toolbar>
        <div class="dialog-toolbar">
          <button
            *ngIf="hasAudio"
            (click)="onPlayClick()"
            mat-mini-fab
            color="accent"
            [class.disappear]="audioPlayBtnClicked"
            [disabled]="audioLoadError"
            [class.appear]="audioEnded"
          >
            <mat-icon>play_arrow</mat-icon>
          </button>
          <solid-core-media-toolbar
            [mediaObject]="data.mediaObject"
            [hasAttributions]="true"
            [hasDialog]="false"
            [hasDziTools]="true"
            [data]="data"
            [isAttributionsOverlayAbove]="isAttributionsOverlayAbove"
            [hasDescription]="hasDescription"
          ></solid-core-media-toolbar>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template #noZoom>
    <div mat-dialog-content>
      <div class="image">
        <img
          [src]="data.mediaObject.getRawImage('large')"
          [alt]="data.mediaObject.alt"
          [class.landscape]="data.mediaObject.isLandscape"
        />
      </div>
      <div class="toolbar-container">
        <div class="spacer"></div>
        <solid-core-audio-toolbar
          class="audio-toolbar"
          *ngIf="hasAudio"
          [audiosrc]="data.mediaObject.audiosrc"
          [toolbar]="true"
          [class.openAudioToolbar]="audioPlayBtnClicked"
          [playAudio]="audioPlayBtnClicked"
          (audioErrorEventEmitter)="handleAudioErrorEvent($event)"
          (audioEndedEventEmitter)="handleAudioEndedEvent($event)"
          [class.closeAudioToolbar]="audioEnded"
        ></solid-core-audio-toolbar>
        <div class="dialog-toolbar">
          <button
            *ngIf="hasAudio"
            (click)="onPlayClick()"
            mat-mini-fab
            color="accent"
            [class.disappear]="audioPlayBtnClicked"
            [disabled]="audioLoadError"
            [class.appear]="audioEnded"
          >
            <mat-icon>play_arrow</mat-icon>
          </button>
          <solid-core-media-toolbar
            [mediaObject]="data.mediaObject"
            [hasAttributions]="true"
            [hasDialog]="false"
            [hasDziTools]="false"
            [data]="data"
            [hasDescription]="hasDescription"
            [isToolbarInDialog]="true"
          ></solid-core-media-toolbar>
        </div>
      </div>
    </div>
  </ng-template>
</ng-container>

<ng-container *ngIf="data.type === 'photograph'">
  <div mat-dialog-title class="mat-dialog-title">
    <div>
      {{ data.name }}
      <span *ngIf="data.image.getTitle" class="media-object-title">
        - {{ data.image.getTitle }}</span
      >
    </div>
    <button mat-icon-button mat-dialog-close>
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <ng-container
    *ngIf="data.image.deepZoomLink as dziFile; then deepZoom; else noZoom"
  ></ng-container>
  <ng-template #deepZoom>
    <div mat-dialog-content>
      <div id="dzi-container"></div>
      <div class="toolbar-container">
        <div class="spacer"></div>
        <solid-core-audio-toolbar
          *ngIf="hasAudio"
          [audiosrc]="data.image.audiosrc"
          [toolbar]="true"
          [class.openAudioToolbar]="audioPlayBtnClicked"
          [playAudio]="audioPlayBtnClicked"
          (audioErrorEventEmitter)="handleAudioErrorEvent($event)"
          (audioEndedEventEmitter)="handleAudioEndedEvent($event)"
          [class.closeAudioToolbar]="audioEnded"
        >
        </solid-core-audio-toolbar>
        <div class="dialog-toolbar">
          <button
            *ngIf="hasAudio"
            (click)="onPlayClick()"
            mat-mini-fab
            color="accent"
            [class.disappear]="audioPlayBtnClicked"
            [disabled]="audioLoadError"
            [class.appear]="audioEnded"
          >
            <mat-icon>play_arrow</mat-icon>
          </button>
          <solid-core-media-toolbar
            [image]="data.image"
            [hasAttributions]="true"
            [hasDialog]="false"
            [hasDziTools]="true"
            [data]="data"
            [isAttributionsOverlayAbove]="isAttributionsOverlayAbove"
            [hasDescription]="hasDescription"
          ></solid-core-media-toolbar>
        </div>
      </div>
    </div>
  </ng-template>
  <ng-template #noZoom>
    <div mat-dialog-content>
      <div class="image">
        <img
          [src]="data.image.getRawImage('large')"
          [alt]="data.image.alt"
          [class.landscape]="data.image.isLandscape"
        />
      </div>
      <div class="toolbar-container">
        <solid-core-audio-toolbar
          *ngIf="hasAudio"
          [audiosrc]="data.image.audiosrc"
          [toolbar]="true"
          [class.openAudioToolbar]="audioPlayBtnClicked"
          [playAudio]="audioPlayBtnClicked"
          (audioErrorEventEmitter)="handleAudioErrorEvent($event)"
          (audioEndedEventEmitter)="handleAudioEndedEvent($event)"
          [class.closeAudioToolbar]="audioEnded"
        >
        </solid-core-audio-toolbar>
        <div class="spacer"></div>
        <div class="dialog-toolbar">
          <button
            *ngIf="hasAudio"
            (click)="onPlayClick()"
            mat-mini-fab
            color="accent"
            [class.disappear]="audioPlayBtnClicked"
            [disabled]="audioLoadError"
            [class.appear]="audioEnded"
          >
            <mat-icon>play_arrow</mat-icon>
          </button>
          <solid-core-media-toolbar
            [image]="data.image"
            [hasAttributions]="true"
            [hasDialog]="false"
            [hasDziTools]="false"
            [data]="data"
            [hasDescription]="hasDescription"
            [isToolbarInDialog]="true"
          ></solid-core-media-toolbar>
        </div>
      </div>
    </div>
  </ng-template>
</ng-container>
